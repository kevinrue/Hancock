<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Concepts on cell types and signatures • hancock</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Concepts on cell types and signatures">
<meta property="og:description" content="hancock">
<meta property="og:image" content="/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hancock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hancock.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/concepts.html">Concepts on cell types and signatures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/kevinrue/hancock/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Concepts on cell types and signatures</h1>
                        <h4 class="author">Kevin Rue-Albrecht</h4>
            <address class="author_afil">
      Kennedy Institute of Rheumatology, University of Oxford, Headington, Oxford OX3 7FY, UK.<br><a class="author_email" href="mailto:#"></a><a href="mailto:kevin.rue-albrecht@kennedy.ox.ac.uk">kevin.rue-albrecht@kennedy.ox.ac.uk</a>
      </address>
                              <h4 class="author">Second Author</h4>
            <address class="author_afil">
      Second Author’s Affiliation<br><a class="author_email" href="mailto:#"></a><a href="mailto:corresponding@author.com">corresponding@author.com</a>
      </address>
                  
            <h4 class="date">25 May 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/kevinrue/hancock/blob/master/vignettes/concepts.Rmd"><code>vignettes/concepts.Rmd</code></a></small>
      <div class="hidden name"><code>concepts.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      A discussion of concepts associated with cell types and transcriptional signatures.
    </div>
    
<p><strong>Compiled date</strong>: 2020-05-25</p>
<p><strong>Last edited</strong>: 2018-03-08</p>
<p><strong>License</strong>: MIT + file LICENSE</p>
<div id="definition-of-cell-identity" class="section level1">
<h1 class="hasAnchor">
<a href="#definition-of-cell-identity" class="anchor"></a>Definition of cell identity</h1>
<p>Discuss:</p>
<ul>
<li>cell type is a continuum (e.g. differentiation, pseudotime)</li>
<li>on a similar note, all cells in an organism basically originate from a common progenitor (itself coming from two, etc.)</li>
<li>cell “states” may be defined similarly to cell “types” (e.g. markers of activated/resting cells)</li>
</ul>
</div>
<div id="definitions" class="section level1">
<h1 class="hasAnchor">
<a href="#definitions" class="anchor"></a>Definitions</h1>
<div id="definitions-of-absolute-and-relative-markers-and-signatures" class="section level2">
<h2 class="hasAnchor">
<a href="#definitions-of-absolute-and-relative-markers-and-signatures" class="anchor"></a>Definitions of absolute and relative markers and signatures</h2>
<p><strong>Absolute markers</strong> (also known as “pan markers”) may be defined as molecules (e.g. protein, transcripts) known to be present or absent in a given population of cells, <em>irrespective of their expression in other cells of the same sample</em>. For instance, T helper lymphocytes can be defined by the presence of surface proteins Cd3 and Cd4, while T cytotoxic lymphocytes are defined by the presence of surface proteins Cd3 and Cd8. To assess whether a cell is likely a T helper lymphocyte, one does not need to know the markers of T cytotoxic lymphocytes, nor that the two cell types have the Cd3 marker in common.</p>
<p><strong>Relative markers</strong> (also known as “key markers”) may be defined by <em>differential</em> expression against other cells in the same sample. For instance, in a biological sample including both T helper and T cytotoxic lymphocytes, differential expression between the two lypmphocyte subsets would highlight Cd4 protein as a (relative) marker of T helper lymphocytes and Cd8 protein as a (relative) marker of T cytotoxic lymphocytes. In contrast, Cd3 protein may be considered as a marker of either cell type only if its expression level or frequency significantly differs between the two cell types.</p>
<p>Note that sets of <strong>absolute markers</strong> may also be trimmed to markers <em>specific</em> to each cell population (i.e., excluding markers present in other signatures), either to increase stringency (due to their specificity) or sensitivity (due to their smaller number). For instance, Cd3 protein being a marker of both T helper and T cytotoxic lymphocytes, one may wish to exclude it from both signatures, in a manner similar–yet more stringent–to <strong>relative markers</strong>. Such markers may be called <strong>relative sets of absolute markers</strong>, as they are composed of <strong>absolute markers</strong> compared to one another in order to identify specific subsets of markers.</p>
</div>
<div id="definitions-qualititative-and-quantitative-signatures" class="section level2">
<h2 class="hasAnchor">
<a href="#definitions-qualititative-and-quantitative-signatures" class="anchor"></a>Definitions qualititative and quantitative signatures</h2>
<p><strong>Qualitative signatures</strong> may be defined as those comprising lists of gene identifiers that are known to be either present or absent in a given population of cells, without <em>any</em> quantitative information (i.e., neither absolute nor relative, see below).</p>
<p><strong>Quantitative signatures</strong> may be defined as either full transcriptional profiles of cell populatitons, or gene lists accompanied with either absolute or relative quantitative gene expression information (e.g., counts, transcripts per million).</p>
<p>In addition, <strong>Semi-quantitative signatures</strong> may be defined as signatures accompanied with summarized gene expression data (e.g., gene rank by decreasing TPM).</p>
</div>
<div id="applications" class="section level2">
<h2 class="hasAnchor">
<a href="#applications" class="anchor"></a>Applications</h2>
<p>The origin of markers and signatures dictates how they should be used in downstream classification tasks.</p>
<div id="markers" class="section level3">
<h3 class="hasAnchor">
<a href="#markers" class="anchor"></a>Markers</h3>
<p><strong>Absolute markers</strong> present the advantage of allowing the immediate characterization of any cell or cluster, without the need of a reference cell of cluster. In this case, each cell or cluster may be screened for the presence of absolute markers, and assigned an identity independently of all other cells in the sample.</p>
<p><strong>Relative markers</strong> can be advantageous when the general cell type composition of a given sample is known in advance, and the problem is only to distribute a predefined set of identities expected in a given sample to a similar number of cell clusters. In this case, differential expression analysis may be performed between clusters of cells in the new sample, and markers of each cluster may be compared to a similar reference sample to assign identities defined in the reference sample to each of the cells or clusters in the new sample. However, cells within a given sample are generally the result of sorting (e.g. FACS) and enriching a population of interest on a set of (protein) markers. In those cases, the markers used for sorting the cells generally appear as highly expressed in all cells, making it difficult or impossible to identify as relative markers.</p>
<p><strong>Relative sets of absolute markers</strong> may be advantageous when dealing with closely related cell populations or novel populations defined by new markers relative to canonical markers and cell types.</p>
</div>
<div id="signatures" class="section level3">
<h3 class="hasAnchor">
<a href="#signatures" class="anchor"></a>Signatures</h3>
<p><strong>Qualitative signatures</strong> may provide particularly fast and convenient ways to apply FACS-like “gating” strategies to the definition of cell identities. The main challenge for such signatures is to define <em>thresholds</em> under and above which transcripts may be considered as absent or present (a natural default threshold being 0). The main advantage of qualitative signatures being that the presence or absence of any transcript should be considerably more stable than its fluctuating expression level.</p>
<p><strong>Quantitative signatures</strong> may provide considerably more precise information on the relative expression level of markers (and other) genes. However, this additional information carries additional constraints and caveats with it, namely:</p>
<ul>
<li>the naturally fluctuating level of transcripts in individual samples means that independent data sets will never produce exactly identical quantitative signatures</li>
<li>in relation to this, quantitative signatures should ideally require users to process and quantitate their new data set <em>identically</em> to the reference data set use to define those signatures; such methods generally limit reproducibility between researchers and software versions, in addition to greatly hindering the definition, distribution, and interpretation of “gold standard” signatures.</li>
</ul>
<p><strong>Semi-quantitative signatures</strong> may provide a compromise between qualitative and quantitaive signatures, summarizing fluctuating <strong>quantitative signatures</strong> into more stable semi-quantitative summary metrics (e.g., gene rank by expression level). For instance, such signatures may be used to identify the most correlated reference sample to any cell or cluster in a new data set, allowing (to some extent) the comparison of even imperfectly correlated quantitative measurements (e.g. TPM and CPM).</p>
</div>
</div>
</div>
<div id="representation-of-signatures" class="section level1">
<h1 class="hasAnchor">
<a href="#representation-of-signatures" class="anchor"></a>Representation of signatures</h1>
<div id="using-list" class="section level2">
<h2 class="hasAnchor">
<a href="#using-list" class="anchor"></a>Lists of marker names</h2>
<p>At its simplest a signature could list <em>positive</em> markers that are known to be expressed in each cell type. For instance, the PBMC signatures used in the Seurat <a href="https://satijalab.org/seurat/pbmc3k_tutorial.html">PBMC 3k tutorial</a> may be represented as follows:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">pbmc3k_markers_list</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="st">"CD4 T cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"IL7R"</span>),
    <span class="st">"CD14+ Monocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD14"</span>, <span class="st">"LYZ"</span>),
    <span class="st">"B cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MS4A1"</span>),
    <span class="st">"CD8 T cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD8A"</span>),
    <span class="st">"FCGR3A+ Monocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span>),
    <span class="st">"NK cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GNLY"</span>, <span class="st">"NKG7"</span>),
    <span class="st">"Dendritic Cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCER1A"</span>, <span class="st">"CST3"</span>),
    <span class="st">"Megakaryocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PPBP"</span>)
)
<span class="no">pbmc3k_markers_list</span>
<span class="co">#&gt; $`CD4 T cells`</span>
<span class="co">#&gt; [1] "IL7R"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CD14+ Monocytes`</span>
<span class="co">#&gt; [1] "CD14" "LYZ" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`B cells`</span>
<span class="co">#&gt; [1] "MS4A1"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`CD8 T cells`</span>
<span class="co">#&gt; [1] "CD8A"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`FCGR3A+ Monocytes`</span>
<span class="co">#&gt; [1] "FCGR3A" "MS4A7" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`NK cells`</span>
<span class="co">#&gt; [1] "GNLY" "NKG7"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $`Dendritic Cells`</span>
<span class="co">#&gt; [1] "FCER1A" "CST3"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $Megakaryocytes</span>
<span class="co">#&gt; [1] "PPBP"</span></pre></body></html></div>
</div>
<div id="using-gseabase" class="section level2">
<h2 class="hasAnchor">
<a href="#using-gseabase" class="anchor"></a>Using GSEABase <code>GeneSetCollection</code>
</h2>
<p>The <em><a href="https://bioconductor.org/packages/3.12/GSEABase">GSEABase</a></em> package provides infrastructure for enumerating pathways and their contents and facilitating translations among the different nomenclatures that are used to describe contents of pathways (<a href="https://support.bioconductor.org/p/27770/">source</a>).</p>
<p>The above list may be more formally (and elegantly) represented as follows:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">GSEABase</span>)
<span class="no">pbmc3k_markers_gsc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html">GeneSetCollection</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"CD4 T cells"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"IL7R"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"CD14+ Monocytes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD14"</span>, <span class="st">"LYZ"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"B cells"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MS4A1"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"CD8 T cells"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD8A"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"FCGR3A+ Monocytes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"NK cells"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GNLY"</span>, <span class="st">"NKG7"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"Dendritic Cells"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCER1A"</span>, <span class="st">"CST3"</span>)),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="kw">setName</span><span class="kw">=</span><span class="st">"Megakaryocytes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PPBP"</span>))
))
<span class="no">pbmc3k_markers_gsc</span>
<span class="co">#&gt; GeneSetCollection</span>
<span class="co">#&gt;   names: CD4 T cells, CD14+ Monocytes, ..., Megakaryocytes (8 total)</span>
<span class="co">#&gt;   unique identifiers: IL7R, CD14, ..., PPBP (12 total)</span>
<span class="co">#&gt;   types in collection:</span>
<span class="co">#&gt;     geneIdType: NullIdentifier (1 total)</span>
<span class="co">#&gt;     collectionType: NullCollection (1 total)</span></pre></body></html></div>
<p>Note that generic R lists can easily be packaged into <em><a href="https://bioconductor.org/packages/3.12/GSEABase">GSEABase</a></em> <code>GeneSetCollection</code> objects, for instance:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">pbmc3k_markers_gsc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html">GeneSetCollection</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/mapply.html">mapply</a></span>(<span class="kw">function</span>(<span class="no">geneIds</span>, <span class="no">geneSetId</span>) {
        <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSet-methods.html">GeneSet</a></span>(<span class="no">geneIds</span>, <span class="kw">geneIdType</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneIdentifierType-constructors.html">EntrezIdentifier</a></span>(),
                <span class="kw">collectionType</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/CollectionType-constructors.html">NullCollection</a></span>(),
                <span class="kw">setName</span><span class="kw">=</span><span class="no">geneSetId</span>)
    }, <span class="no">pbmc3k_markers_list</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">pbmc3k_markers_list</span>)))</pre></body></html></div>
</div>
<div id="using-unisets" class="section level2">
<h2 class="hasAnchor">
<a href="#using-unisets" class="anchor"></a>Using unisets <code>Sets</code>
</h2>
<p>The <em><a href="https://github.com/kevinrue/unisets">unisets</a></em> package is being developed using <em><a href="https://bioconductor.org/packages/3.12/S4Vectors">S4Vectors</a></em> <code>Hits</code> to associate identifiers in a vector of elements to identifiers in a vector of sets.</p>
<p>The package can be installed as follows:</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"kevinrue/unisets"</span>)</pre></body></html></div>
<p>Conveniently, this package supports multiple source formats to create gene sets, including <code>list</code> described <a href="#using-list">above</a>.</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">unisets</span>)
<span class="no">inputList</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="st">"CD4 T cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"IL7R"</span>),
    <span class="st">"CD14+ Monocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD14"</span>, <span class="st">"LYZ"</span>),
    <span class="st">"B cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"MS4A1"</span>),
    <span class="st">"CD8 T cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"CD8A"</span>),
    <span class="st">"FCGR3A+ Monocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCGR3A"</span>, <span class="st">"MS4A7"</span>),
    <span class="st">"NK cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"GNLY"</span>, <span class="st">"NKG7"</span>),
    <span class="st">"Dendritic Cells"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"FCER1A"</span>, <span class="st">"CST3"</span>),
    <span class="st">"Megakaryocytes"</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"PPBP"</span>)
)
<span class="no">pbmc3k_markers_sets</span> <span class="kw">&lt;-</span> <span class="fu">as</span>(<span class="no">inputList</span>, <span class="st">"Sets"</span>)
<span class="no">pbmc3k_markers_sets</span>
<span class="co">#&gt; Sets with 12 relations between 12 elements and 8 sets</span>
<span class="co">#&gt;          element             set</span>
<span class="co">#&gt;      &lt;character&gt;     &lt;character&gt;</span>
<span class="co">#&gt;  [1]        IL7R     CD4 T cells</span>
<span class="co">#&gt;  [2]        CD14 CD14+ Monocytes</span>
<span class="co">#&gt;  [3]         LYZ CD14+ Monocytes</span>
<span class="co">#&gt;  [4]       MS4A1         B cells</span>
<span class="co">#&gt;  [5]        CD8A     CD8 T cells</span>
<span class="co">#&gt;  ...         ...             ...</span>
<span class="co">#&gt;  [8]        GNLY        NK cells</span>
<span class="co">#&gt;  [9]        NKG7        NK cells</span>
<span class="co">#&gt; [10]      FCER1A Dendritic Cells</span>
<span class="co">#&gt; [11]        CST3 Dendritic Cells</span>
<span class="co">#&gt; [12]        PPBP  Megakaryocytes</span>
<span class="co">#&gt; -----------</span>
<span class="co">#&gt; elementInfo: IdVector with 0 metadata</span>
<span class="co">#&gt;     setInfo: IdVector with 0 metadata</span></pre></body></html></div>
</div>
<div id="combinations-of-positive-and-negative-markers-using-the-genecolorset-class" class="section level2">
<h2 class="hasAnchor">
<a href="#combinations-of-positive-and-negative-markers-using-the-genecolorset-class" class="anchor"></a>Combinations of positive and negative markers using the <code>GeneColorSet</code> class</h2>
<p>“Colored” gene sets, implemented in the <em><a href="https://bioconductor.org/packages/3.12/GSEABase">GSEABase</a></em> <code>GeneColorSet</code> class, can store information about the relation between each gene and a given phenotype. Here, “colors” are <code>factor</code> levels used to represent the “state” of each gene (e.g., expression levels “up”, “down”, or “unchanged”), and a phenotypic consequence (e.g., the phenotype is “enhanced” or “reduced”). For the purpose of signatures associated with individual cell types, we may consider the identity of a differentiated cell as the phenotype of interest.</p>
<p>In particular, individual genes may be positively or negatively associated with certain populations of cells. Such genes may be called <strong>positive</strong> or <strong>negative</strong> markers for the associated cell population.</p>
<p>For instance, the differentiation of monocytes into mature F4/80<sup>hi</sup> CX3CR1<sup>hi</sup> MHCII<sup>+</sup> macrophages in the murine colonic mucosa is described as a “waterfall” that visually describes the concomitant downregulation of Ly6C and upregulation of MHCII <span class="citation">(Tamoutounour et al. 2012)</span>.</p>
<p>Conceptually, the transcriptional signatures of Ly6C<sup>hi</sup> monocytes and mature F4/80<sup>hi</sup> CX3CR1<sup>hi</sup> MHCII<sup>+</sup> macrophages may be represented as follows:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="no">colored_gsc</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneSetCollection-methods.html">GeneSetCollection</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneColorSet-methods.html">GeneColorSet</a></span>(
        <span class="kw">setName</span><span class="kw">=</span><span class="st">"Monocytes"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ly6c1"</span>, <span class="st">"MHCII"</span>), <span class="kw">phenotype</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ly6Chi"</span>),
        <span class="kw">geneColor</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"high"</span>, <span class="st">"-"</span>)),
        <span class="kw">phenotypeColor</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">TRUE</span>, <span class="fl">TRUE</span>))),
    <span class="fu"><a href="https://rdrr.io/pkg/GSEABase/man/GeneColorSet-methods.html">GeneColorSet</a></span>(
        <span class="kw">setName</span><span class="kw">=</span><span class="st">"Macrophages"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Ly6c1"</span>, <span class="st">"MHCII"</span>), <span class="kw">phenotype</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"mature F4/80hi CX3CR1hi MHCII+"</span>),
        <span class="kw">geneColor</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"low"</span>, <span class="st">"+"</span>)),
        <span class="kw">phenotypeColor</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">TRUE</span>, <span class="fl">TRUE</span>)))
))
<span class="no">colored_gsc</span>
<span class="co">#&gt; GeneSetCollection</span>
<span class="co">#&gt;   names: Monocytes, Macrophages (2 total)</span>
<span class="co">#&gt;   unique identifiers: Ly6c1, MHCII (2 total)</span>
<span class="co">#&gt;   types in collection:</span>
<span class="co">#&gt;     geneIdType: NullIdentifier (1 total)</span>
<span class="co">#&gt;     collectionType: NullCollection (1 total)</span></pre></body></html></div>
<p>The monocytic signature can be extracted, for further inspection.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">colored_gsc</span><span class="kw">[[</span><span class="st">"Monocytes"</span>]]
<span class="co">#&gt; setName: Monocytes </span>
<span class="co">#&gt; geneIds: Ly6c1, MHCII (total: 2)</span>
<span class="co">#&gt; geneIdType: Null</span>
<span class="co">#&gt; collectionType: Null </span>
<span class="co">#&gt; phenotype: Ly6Chi </span>
<span class="co">#&gt; geneColor: high, -</span>
<span class="co">#&gt;   levels: -, high</span>
<span class="co">#&gt; phenotypeColor: TRUE, TRUE</span>
<span class="co">#&gt;   levels: TRUE</span>
<span class="co">#&gt; details: use 'details(object)'</span></pre></body></html></div>
<p>It is also possible to examine the relationship of individual markers with respect to the “Ly6Chi Monocyte” phenotype.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">colored_gsc</span><span class="kw">[[</span><span class="st">"Monocytes"</span>]]<span class="kw">[[</span><span class="st">"Ly6c1"</span>]]
<span class="co">#&gt;         geneId      geneColor phenotypeColor </span>
<span class="co">#&gt;        "Ly6c1"         "high"         "TRUE"</span>
<span class="no">colored_gsc</span><span class="kw">[[</span><span class="st">"Monocytes"</span>]]<span class="kw">[[</span><span class="st">"MHCII"</span>]]
<span class="co">#&gt;         geneId      geneColor phenotypeColor </span>
<span class="co">#&gt;        "MHCII"            "-"         "TRUE"</span></pre></body></html></div>
</div>
</div>
<div id="session-info" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session info</h1>
<pre><code>#&gt; R Under development (unstable) (2020-05-25 r78569)
#&gt; Platform: x86_64-pc-linux-gnu (64-bit)
#&gt; Running under: Ubuntu 16.04.6 LTS
#&gt; 
#&gt; Matrix products: default
#&gt; BLAS:   /home/travis/R-bin/lib/R/lib/libRblas.so
#&gt; LAPACK: /home/travis/R-bin/lib/R/lib/libRlapack.so
#&gt; 
#&gt; locale:
#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              
#&gt;  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    
#&gt;  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   
#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 
#&gt;  [9] LC_ADDRESS=C               LC_TELEPHONE=C            
#&gt; [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       
#&gt; 
#&gt; attached base packages:
#&gt; [1] stats4    parallel  stats     graphics  grDevices utils     datasets 
#&gt; [8] methods   base     
#&gt; 
#&gt; other attached packages:
#&gt;  [1] unisets_0.99.0       GSEABase_1.51.0      graph_1.67.0        
#&gt;  [4] annotate_1.67.0      XML_3.99-0.3         AnnotationDbi_1.51.0
#&gt;  [7] IRanges_2.23.5       S4Vectors_0.27.7     Biobase_2.49.0      
#&gt; [10] BiocGenerics_0.35.2  BiocStyle_2.17.0    
#&gt; 
#&gt; loaded via a namespace (and not attached):
#&gt;  [1] SummarizedExperiment_1.19.4 xfun_0.14                  
#&gt;  [3] reshape2_1.4.4              lattice_0.20-41            
#&gt;  [5] vctrs_0.3.0                 htmltools_0.4.0            
#&gt;  [7] rtracklayer_1.49.1          yaml_2.2.1                 
#&gt;  [9] blob_1.2.1                  rlang_0.4.6                
#&gt; [11] pkgdown_1.5.1               DBI_1.1.0                  
#&gt; [13] BiocParallel_1.23.0         bit64_0.9-7                
#&gt; [15] matrixStats_0.56.0          GenomeInfoDbData_1.2.3     
#&gt; [17] plyr_1.8.6                  stringr_1.4.0              
#&gt; [19] zlibbioc_1.35.0             Biostrings_2.57.0          
#&gt; [21] memoise_1.1.0               evaluate_0.14              
#&gt; [23] knitr_1.28                  GenomeInfoDb_1.25.0        
#&gt; [25] Rcpp_1.0.4.6                xtable_1.8-4               
#&gt; [27] backports_1.1.7             BiocManager_1.30.10        
#&gt; [29] DelayedArray_0.15.1         desc_1.2.0                 
#&gt; [31] XVector_0.29.1              fs_1.4.1                   
#&gt; [33] bit_1.1-15.2                Rsamtools_2.5.0            
#&gt; [35] digest_0.6.25               stringi_1.4.6              
#&gt; [37] bookdown_0.19               grid_4.1.0                 
#&gt; [39] GenomicRanges_1.41.1        rprojroot_1.3-2            
#&gt; [41] tools_4.1.0                 bitops_1.0-6               
#&gt; [43] magrittr_1.5                RCurl_1.98-1.2             
#&gt; [45] RSQLite_2.2.0               crayon_1.3.4               
#&gt; [47] Matrix_1.2-18               MASS_7.3-51.6              
#&gt; [49] assertthat_0.2.1            rmarkdown_2.1              
#&gt; [51] R6_2.4.1                    GenomicAlignments_1.25.0   
#&gt; [53] compiler_4.1.0</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-monocytewaterfall2012">
<p>Tamoutounour, S., S. Henri, H. Lelouard, B. de Bovis, C. de Haar, C. J. van der Woude, A. M. Woltman, et al. 2012. “CD64 Distinguishes Macrophages from Dendritic Cells in the Gut and Reveals the Th1-Inducing Role of Mesenteric Lymph Node Macrophages During Colitis.” Journal Article. <em>Eur J Immunol</em> 42 (12): 3150–66. <a href="https://doi.org/10.1002/eji.201242847" class="uri">https://doi.org/10.1002/eji.201242847</a>.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Robert Amezquita, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
