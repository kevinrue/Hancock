<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify the Dominant Signatures in Clusters of Samples — plotProportionPositive • hancock</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Identify the Dominant Signatures in Clusters of Samples — plotProportionPositive" />

<meta property="og:description" content="The predictByProportionPositive() function computes the proportion of samples positive for each signature in each (predefined) cluster
and identifies the predominant signature in each cluster.
The function stores information tracing the prediction process in the metadata slot. See Details." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hancock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hancock.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/concepts.html">Concepts on cell types and signatures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kevinrue/hancock">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify the Dominant Signatures in Clusters of Samples</h1>
    <small class="dont-index">Source: <a href='https://github.com/kevinrue/hancock/blob/master/R/plot-methods.R'><code>R/plot-methods.R</code></a>, <a href='https://github.com/kevinrue/hancock/blob/master/R/predict-methods.R'><code>R/predict-methods.R</code></a></small>
    <div class="hidden name"><code>predictByProportionPositive.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>The <code>predictByProportionPositive()</code> function computes the proportion of samples positive for each signature in each (predefined) cluster
and identifies the predominant signature in each cluster.
The function stores information tracing the prediction process in the <code>metadata</code> slot. See Details.</p>
    
    </div>

    <pre class="usage"><span class='fu'>plotProportionPositive</span>(<span class='no'>se</span>, <span class='no'>...</span>, <span class='kw'>row_title</span> <span class='kw'>=</span> <span class='st'>"Signature"</span>,
  <span class='kw'>row_title_side</span> <span class='kw'>=</span> <span class='st'>"left"</span>, <span class='kw'>column_title</span> <span class='kw'>=</span> <span class='st'>"Cluster"</span>,
  <span class='kw'>column_title_side</span> <span class='kw'>=</span> <span class='st'>"top"</span>)

<span class='fu'>predictByProportionPositive</span>(<span class='no'>object</span>, <span class='no'>se</span>, <span class='no'>cluster.col</span>,
  <span class='kw'>assay.type</span> <span class='kw'>=</span> <span class='st'>"counts"</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>se</th>
      <td><p>An object of class inheriting from <code>SummarizedExperiment</code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Additional arguments to be passed to methods.</p></td>
    </tr>
    <tr>
      <th>row_title, row_title_side, column_title, column_title_side</th>
      <td><p>See <code>Heatmap()</code>.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>A collection of signatures inheriting from <code>Sets</code> or <code>GeneSetCollection</code>".</p></td>
    </tr>
    <tr>
      <th>cluster.col</th>
      <td><p>Name of a column in <code>colData(se)</code> that contains
a factor indicating cluster membership for each column (i.e. sample) in <code>se</code>.</p></td>
    </tr>
    <tr>
      <th>assay.type</th>
      <td><p>A string specifying which assay values to use, e.g., <code>"counts"</code> or <code>"logcounts"</code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Value <em>above which</em> the marker is considered detected.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>The object <code>se</code>, updated as follows:</p><ul>
<li><p>in the <code>metadata</code> slot, a <code>"hancock"</code> item is added (or updated) with information tracing the prediction process. See Details.</p></li>
<li><p>in the <code>colData</code> slot, a <code>DataFrame</code> is nested in a new (or updated) <code>"hancock"</code> column.
This DataFrame contains predicted labels in the first and only column.</p></li>
</ul>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The function populates the <code>"hancock"</code> element of the <code>metadata</code> slot with the following fields and values:</p><dl class='dl-horizontal'>
<dt><code>"GeneSets"</code></dt><dd><p>Signatures used to make the predictions</p></dd>
<dt><code>"method"</code></dt><dd><p>Name of the method used to make the predictions</p></dd>
<dt><code>"packageVersion"</code></dt><dd><p><code>hancock</code> version used to make the predictions</p></dd>
<dt><code>"ProportionPositiveByCluster"</code></dt><dd><p>Matrix indicating the proportion of samples in each cluster that are positive for each signature.</p></dd>
<dt><code>"TopSignatureByCluster"</code></dt><dd><p>Named vector indicating the predominant signature for each cluster.</p></dd>
</dl>
    
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    <ul>
<li><p><code>plotProportionPositive</code>: Returns a <code>Heatmap</code> displaying the proportion (on a scale from 0 to 100) of samples that are positive for each individual signature in each cluster.</p></li>
</ul>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='predictSignatures.html'>predict.GeneSetCollection()</a></code>, <code><a href='predictSignatures.html'>predict.Sets()</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example data ----</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SummarizedExperiment</span>)
<span class='no'>nsamples</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>u</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>20000</span>, <span class='fl'>1</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>nsamples</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>u</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"Gene"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sprintf'>sprintf</a></span>(<span class='st'>"%03d"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>u</span>))))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>u</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"Cell"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sprintf'>sprintf</a></span>(<span class='st'>"%03d"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>u</span>))))
<span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/RangedSummarizedExperiment-class'>SummarizedExperiment</a></span>(<span class='kw'>assays</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>counts</span><span class='kw'>=</span><span class='no'>u</span>))

<span class='no'>bs</span> <span class='kw'>&lt;-</span> <span class='fu'>Sets</span>(
    <span class='kw'>relations</span><span class='kw'>=</span><span class='fu'>DataFrame</span>(
        <span class='kw'>element</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"Gene001"</span>, <span class='st'>"Gene002"</span>, <span class='st'>"Gene003"</span>, <span class='st'>"Gene004"</span>),
        <span class='kw'>set</span>     <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"Cell type 1"</span>, <span class='fl'>2</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(<span class='st'>"Cell type 2"</span>, <span class='fl'>2</span>))
    )
)
<span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)[, <span class='st'>"cluster"</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>LETTERS</span>, <span class='fl'>3</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>se</span>), <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>))

<span class='co'># Example usage ----</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>circlize</span>)</div><div class='output co'>#&gt; <span class='message'>========================================</span>
#&gt; <span class='message'>circlize version 0.4.6</span>
#&gt; <span class='message'>CRAN page: https://cran.r-project.org/package=circlize</span>
#&gt; <span class='message'>Github page: https://github.com/jokergoo/circlize</span>
#&gt; <span class='message'>Documentation: http://jokergoo.github.io/circlize_book/book/</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>If you use it in published research, please cite:</span>
#&gt; <span class='message'>Gu, Z. circlize implements and enhances circular visualization </span>
#&gt; <span class='message'>  in R. Bioinformatics 2014.</span>
#&gt; <span class='message'>========================================</span></div><div class='input'><span class='co'># Identify the dominant signature in each cluster</span>
<span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'>predictByProportionPositive</span>(<span class='no'>bs</span>, <span class='no'>se</span>, <span class='kw'>cluster.col</span><span class='kw'>=</span><span class='st'>"cluster"</span>)
<span class='co'># Visualise the proportion of samples positive for each signature in each cluster</span>
<span class='fu'>plotProportionPositive</span>(
  <span class='no'>se</span>, <span class='kw'>cluster_rows</span><span class='kw'>=</span><span class='fl'>FALSE</span>, <span class='kw'>cluster_columns</span><span class='kw'>=</span><span class='fl'>FALSE</span>,
  <span class='kw'>col</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/circlize/topics/colorRamp2'>colorRamp2</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>100</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"white"</span>, <span class='st'>"red"</span>)))</div><div class='img'><img src='predictByProportionPositive-1.png' alt='' width='700' height='433' /></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#functions">Functions</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Kevin Rue-Albrecht</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Robert Amezquita, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

