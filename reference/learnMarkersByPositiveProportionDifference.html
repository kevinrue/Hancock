<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Identify Markers by Largest Difference of Detection Rate in Clusters — learnMarkersByPositiveProportionDifference • hancock</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Identify Markers by Largest Difference of Detection Rate in Clusters — learnMarkersByPositiveProportionDifference" />

<meta property="og:description" content="This function computes the detection rate of each feature in each cluster.
For each cluster, it ranks all the features by decreasing difference between
the detection rate in the target cluster, and the detection rate in all other clusters.
The function can limit results up to n markers for each cluster." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">hancock</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/hancock.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/concepts.html">Concepts on cell types and signatures</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/kevinrue/hancock">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Identify Markers by Largest Difference of Detection Rate in Clusters</h1>
    <small class="dont-index">Source: <a href='https://github.com/kevinrue/hancock/blob/master/R/learn-methods.R'><code>R/learn-methods.R</code></a></small>
    <div class="hidden name"><code>learnMarkersByPositiveProportionDifference.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function computes the detection rate of each feature in each cluster.
For each cluster, it ranks all the features by decreasing difference between
the detection rate in the target cluster, and the detection rate in all other clusters.
The function can limit results up to <code>n</code> markers for each cluster.</p>
    
    </div>

    <pre class="usage"><span class='fu'>learnMarkersByPositiveProportionDifference</span>(<span class='no'>se</span>, <span class='no'>cluster.col</span>,
  <span class='kw'>assay.type</span> <span class='kw'>=</span> <span class='st'>"counts"</span>, <span class='kw'>threshold</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>Inf</span>, <span class='kw'>min.diff</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>min.prop</span> <span class='kw'>=</span> <span class='fl'>0.1</span>, <span class='kw'>diff.method</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"min"</span>, <span class='st'>"mean"</span>, <span class='st'>"median"</span>, <span class='st'>"max"</span>))</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>se</th>
      <td><p>An object of class inheriting from "<code>SummarizedExperiment</code>".</p></td>
    </tr>
    <tr>
      <th>cluster.col</th>
      <td><p>Name of a column in <code>colData(se)</code> that contains
a factor indicating cluster membership for each column (i.e. sample) in <code>se</code>.</p></td>
    </tr>
    <tr>
      <th>assay.type</th>
      <td><p>A string specifying which assay values to use, e.g., <code>"counts"</code> or <code>"logcounts"</code>.</p></td>
    </tr>
    <tr>
      <th>threshold</th>
      <td><p>Value <em>above which</em> the marker is considered detected.</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Maximal number of markers allowed for each signature.</p></td>
    </tr>
    <tr>
      <th>min.diff</th>
      <td><p>Minimal difference in detection rate between the target cluster
and the summarized detection rate in any other cluster (in the range 0-1).
See argument <code>diff.method</code>.</p></td>
    </tr>
    <tr>
      <th>min.prop</th>
      <td><p>Minimal proportion of samples in the target cluster where the combined set of markers is detected.</p></td>
    </tr>
    <tr>
      <th>diff.method</th>
      <td><p>Method to contrast the detection rate in the target cluster to that of all other clusters.
See Details section.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A collection of signatures as a "<code>Sets</code>" object.</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p><code>diff.method</code> controls how the detection rate in all clusters <em>other than the target one</em> are summarized before comparison with the detection in the target cluster.
It is possible to rank features using the minimal (<code>"min"</code>), <code>"mean"</code>, <code>"median"</code>, or maximal (<code>"max"</code>) difference between the detection rate in the target cluster and those of all other clusters.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='learnSignatures.html'>learnSignatures</a></code>.</p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Example data ----</span>
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/library'>library</a></span>(<span class='no'>SummarizedExperiment</span>)
<span class='no'>nsamples</span> <span class='kw'>&lt;-</span> <span class='fl'>100</span>
<span class='no'>u</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/matrix'>matrix</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/stats/topics/Poisson'>rpois</a></span>(<span class='fl'>20000</span>, <span class='fl'>1</span>), <span class='kw'>ncol</span><span class='kw'>=</span><span class='no'>nsamples</span>)
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>rownames</a></span>(<span class='no'>u</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"Gene"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sprintf'>sprintf</a></span>(<span class='st'>"%03d"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>nrow</a></span>(<span class='no'>u</span>))))
<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/colnames'>colnames</a></span>(<span class='no'>u</span>) <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/paste'>paste0</a></span>(<span class='st'>"Cell"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sprintf'>sprintf</a></span>(<span class='st'>"%03d"</span>, <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/seq'>seq_len</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>u</span>))))
<span class='no'>se</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/RangedSummarizedExperiment-class'>SummarizedExperiment</a></span>(<span class='kw'>assays</span><span class='kw'>=</span><span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list'>list</a></span>(<span class='kw'>counts</span><span class='kw'>=</span><span class='no'>u</span>))

<span class='fu'><a href='https://www.rdocumentation.org/packages/SummarizedExperiment/topics/SummarizedExperiment-class'>colData</a></span>(<span class='no'>se</span>)[, <span class='st'>"cluster"</span>] <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/factor'>factor</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/sample'>sample</a></span>(<span class='fu'><a href='https://www.rdocumentation.org/packages/utils/topics/head'>head</a></span>(<span class='no'>LETTERS</span>, <span class='fl'>3</span>), <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/nrow'>ncol</a></span>(<span class='no'>se</span>), <span class='kw'>replace</span><span class='kw'>=</span><span class='fl'>TRUE</span>))

<span class='co'># Example usage ----</span>

<span class='no'>baseset</span> <span class='kw'>&lt;-</span> <span class='fu'>learnMarkersByPositiveProportionDifference</span>(<span class='no'>se</span>, <span class='kw'>cluster.col</span><span class='kw'>=</span><span class='st'>"cluster"</span>)

<span class='fu'>relations</span>(<span class='no'>baseset</span>)</div><div class='output co'>#&gt; Hits object with 27 hits and 2 metadata columns:
#&gt;             from        to | ProportionPositive minDifferenceProportion
#&gt;        &lt;integer&gt; &lt;integer&gt; |          &lt;numeric&gt;               &lt;numeric&gt;
#&gt;    [1]         1         1 |  0.814814814814815       0.267195767195767
#&gt;    [2]         2         1 |  0.777777777777778       0.229390681003584
#&gt;    [3]         3         1 |  0.777777777777778       0.158730158730159
#&gt;    [4]         4         1 |  0.814814814814815       0.148148148148148
#&gt;    [5]         5         1 |  0.851851851851852       0.142174432497013
#&gt;    ...       ...       ... .                ...                     ...
#&gt;   [23]        23         3 |  0.806451612903226       0.163594470046083
#&gt;   [24]        24         3 |  0.741935483870968       0.149342891278375
#&gt;   [25]        25         3 |  0.741935483870968       0.146697388632873
#&gt;   [26]        26         3 |  0.806451612903226       0.139784946236559
#&gt;   [27]        27         3 |  0.741935483870968       0.122887864823349
#&gt;   -------
#&gt;   nLnode: 27 / nRnode: 3</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Kevin Rue-Albrecht</p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Kevin Rue-Albrecht, Robert Amezquita, Aaron Lun.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

